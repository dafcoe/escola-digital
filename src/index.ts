import puppeteer  from 'puppeteer';
import { login } from './pages/login/login.page';
import { logout } from './pages/logout/logout.page';
import { generateStudentAssignmentsByClassNameReport } from './reports/assignments-student';

async function run(): Promise<void> {
  const browser = await puppeteer.launch();
  globalThis.page  = await browser.newPage();
  await page.setViewport({ width: 1920, height: 1080 });

  await login();
  await generateStudentReports();
  await logout();

  await browser.close();
}

async function generateStudentReports(): Promise<void> {
  const studentNifsByClassName: Record<string, string[]>[] = [
    { '7 A': ['277919908', '277571871', '278096735', '289047110', '279279353', '320940934', '306972158', '280882394', '280614268', '277451825', '238146421', '302319140', '280240805', '279774770', '278535950', '279889364', '278242782', '277677831', '277419409', '295426683', '279558350', '277399696', '274959879', '278476171', '280092911'] },
    { '7 B': ['279857594', '319543307', '279723644', '277525730', '280984197', '272902373', '279233795', '270833730', '278446442', '278187951', '277299454', '278478930', '277939984', '277143349', '277160413', '275258521', '277710405', '277782937', '273470744', '279424205', '277502519', '278254454'] },
    { '7 C': ['280146540', '280146710', '279058233', '278338127', '284225096', '294400370', '275176630', '283263660', '277125200', '279075278', '279713436', '277684838', '279757778', '276518527', '276760328', '238767183', '279574991', '278604978', '283253924', '278218750'] },

    { '8 A': ['278107010', '272472832', '304350044', '277920167', '276542339', '275767930', '275631427', '275056635', '273245694', '298781972', '278367968', '276432614', '273833170', '275862607', '274632870', '276017994', '278260128', '273328522', '275077179', '270652132', '275572846', '278351425', '269185925', '278436951', '320768295'] },
    { '8 B': ['277810744', '274188813', '276057848', '275142310', '274182580', '276844173', '319293556', '298782138', '323038743', '277203554', '276631943', '277431794', '273222813', '276951816', '273261347', '277575397', '277961564', '278370489', '276459237', '278370292', '274514940'] },
    { '8 C': ['285593757', '273220934', '277227780', '278120261', '276515900', '272824836', '277760020', '277084750', '278133436', '276150333', '275326284', '275430200', '323628117', '276302273', '273079476', '274815745', '276894588', '275293904', '275089304', '277911478', '290575095'] },

    { '9 A': ['272916846', '273767518', '272261408', '315616431', '268731977', '317782657', '269259520', '278961223', '270402357', '273984187', '272761770', '318771624', '275164047', '272915874', '269289798', '271241195', '268935262', '270770283', '272617440', '273362895', '270258000', '271574950', '273868128', '273128442', '270234535', '274977648'] },
    { '9 B': ['291906389', '273556002', '264085019', '267814518', '273789546', '273867202', '270119191', '268887756', '273597345', '271587466', '269139176', '277701821', '214916995', '274918811', '275308421', '271795603', '312277075', '273770438', '313530823', '273496980', '269334858'] },

    { '9 CEF OPEC': ['293549389', '262679663', '273600702', '298061449', '273571222', '272336700', '274611171', '275833844', '278643558', '290574978', '269100415', '273921037', '293549230', '274348292', '268727058', '263120171', '269245391', '300862520'] },

    { '10 A': ['266276547', '275293041', '269357394', '269678379', '272004693', '271474556', '268191387', '273733923', '268294763', '267449976', '275321487', '273360612', '273640275', '267762607', '269829695', '272298379', '268026378', '269829849', '274589656', '315207973', '266745385', '268198098'] },
    { '10 B': ['273925296', '270286977', '324315864', '274302500', '324848080', '272134848', '279670320', '265279992', '274681218', '269366130', '270972587', '269082433', '271468734', '270122834', '265412536', '271541865', '268958475', '267202873', '311848516', '269918892', '275749622', '273569236', '268082553', '268761612', '270216367', '268948240'] },
    { '10 C': ['265734320', '268282692', '268673748', '289322022', '266800360', '274918404', '271192615', '271609702', '275829642', '269135618', '275183327', '274912597'] },
    { '10 D': ['268341087', '274407388', '278377696', '274121050', '278331076', '264751787', '273968351', '274976749', '269437207', '265918375', '310652065', '274496178', '296773492', '268277311', '270602275', '269063218', '271474203', '274529386', '297702726', '306965747', '287352943', '266184430', '270844422', '295764430'] },
    { '10 E': ['272606707', '275192598', '266238432', '274199939', '275247090', '324874480', '277031559', '275093867', '266276539', '315942509', '266448780', '270155023', '307128652', '269223401', '264831977'] },
    { '10 F': ['274346524', '273302027', '317990306', '277251095', '278588379', '275350134', '267642296', '274844699', '270449620', '268271720', '271978856', '269053719', '272886580', '266575994', '303963433', '273956914', '268932344', '267008619', '268695008', '269684654', '269796487', '267044747', '276851730', '273596144'] },
    { '10 G': ['270182446', '272617806', '273789660', '268830711', '275969410', '275426440', '270355707', '274128969', '260036315', '273331540', '270159932', '272998613', '268026114', '274029847', '275361217', '272996114', '273774433', '274430053', '322443342', '266210937', '275141764', '270521372', '269569170', '273628852'] },
    { '10 H': ['268901716', '275740161', '299648451', '267212909', '272485659', '273862189', '275148467', '275676552', '269493700', '304343412', '262477629', '273003038', '272122556', '278538088', '270199071', '274718278', '272822752', '299624773', /*'0', */'266578748', '273129660', '270280952', '275750698', '266576354'] },
    { '10 I': ['274518759', '275154068', '271819057', '280322356', '269174648', '270360123', '276988230', '273181815', '269673687', '274915170', '269352465', '269245170', '273760068', '327366109', '258810408', '274519224', '273218417', '273935968', '277256917', '271834188', '267237758', '274508249', '275067424', '272987980', '273578375', '266473016', '273247026', '297905082'] },

    { '11 A': ['326083448', '265762898', '323706614', '297156136', '267820852', '266057241', '268501190', '261063332', '268250243', '268189080', '279997922', '323699510', '269085408', '270159428', '267644590', '268639221', '265283353', '265132070', '263094944', '266582672', '274633477', '263237869', '302092285', '265596645', '273829610', '273206206'] },
    { '11 B': ['273188070', '264998448', '275040003', '265185238', '266155510', '271527013', '270304622', '266325130', '265580722', '323533140', '260750018', '266391281', '264857143', '321889355', '326707581', '263169235', '275469131', '266232612', '262636000', '266130500', '323440622', '268865574', '290525926'] },
    { '11 C': ['274789892', '275409325', '263581217', '274458721', '302813810', '264412869', '274494809', '269637478', '314403736', '263773205', '306604574', '263085724', '324778619', '270572473', '275416259', '264242998', '270121986', '265984971', '268588554', '268371008', '260644790', '265605121', '269809147'] },
    { '11 D': ['265972086', '259435600', '266806236', '268459576', '264053281', '266419020', '272769851', '270811591', '265202930', '265453046', '268531641', '292867638'] },
    { '11 E': ['292512430', '273909495', '265038790', '261730525', '264119487', '267817223', '261477692', '266946135', '270699546', '266693679', '273573780', '269418385', '264397185', '272606634', '268604290', '275539075', '265032369', '261636979', '274809761', '275025640', '319741311', '273406825', '273703161', '262799090', '324433638'] },
    { '11 F': ['264300785', '265334268', '273817302', '268882762', '274976463', '274791080', '266210970', '273551604', '267028083', '265590000', '265242258', '265603935', '262869918', '273875191', '289206308', '268714827', '268644080', '265974801', '274180286', '300323450'] },
    { '11 G': ['262818671', '268170207', '265130034', '280898436', '269685243', '271801050', '269336354', '265616689', '273451669', '266107214', '264417224', '273950550'] },
    { '11 H': ['265736862', '265159474', '271266457', '283755628', '263204286', '266418821', '271067381', '256852057', '275163946', '274935899', '272655198', '275388441', '272479721', '274735865', '280758871', '273934422', '270063927', '265299390', '266384285', '264857364', '268229724'] },
    { '11 I': ['274464713', '273044516', '273618644', '315616644', '262269929', '273450913', '272067202', '275504085', '273730193', '272961469', '273551671', '301873496', '272054054', '265341906', '258842237', '265239346', '264960971', '268913960', '273680617', '256480605', '262772140', '275217213', '264102800'] },
    { '11 J': ['264292766', '263945839', '273686089', '265342325', '265804469', '321173520', '273053027', '262772272', '263064530', '269434488', '265164532', '263371689', '271870630', '268988790', '275197786', '264460812', '266899196'] },

    { '12 A': ['262971194', '265090369', '275822591', '259880639', '265177090', '272100781', '262363941', '271615079', '270076549', '259500933', '271188995', '261849026', '272786268', '273606085', '264867068', '273152912', '269100270', '261079638', '273670611', '275141209', '276658540', '266552625', '259299723', '265749565', '261035800'] },
    { '12 B': ['269985735', '271452773', '272004502', '260783005', '270103589', '283971070', '256589887', '262958376', '272925403', '258844426', '259104990', '273867644', '269216731', '265303982', '260756784', '261298828', '271369698', '262045796', '262689200', '310576598', '273639579', '265032369'] },
    { '12 C': ['287541339', '273642642', '264112741', '260432059', '275026841', '273638874', '271935464', '273896210', '261405802', '272001163', '261063332', '268382751', '278916414', '268266794', '280342276', '267217110', '259436437', '273775804', '266055729', '259665479', '265483484', '274178907', '274944146', '273859056', '300135858'] },
    { '12 D': ['298695782', '313530785', '274372371', '262189852', '269296158', '284828807', '260346900', '275260615', '258987081', '310320399', '259729787', '273641999', '265032369', '283974486'] },
    { '12 E': ['273278916', '265683041', '262463865', '273945211', '261412809', '274399814', '265090598', '262796570', '262588439', '260604305', '269332758', '275459209', '265459338', '274431025', '264207939', '262227991', '260635944', '273651404', '270075585'] },
    { '12 F': ['273640860', '270110534', '262660547', '267770340', '264188225', '270303502', '264918460', '259755389', '261292153', '264340523', '275535681', '289273170', '265565839', '265503582'] },
    { '12 G': ['273605771', '318038161', '262799219', '274464713', '264296192', '271267771', '269405364', '264425421', '273656139', '273856804', '273659243', '274407574', '273199587', '265308445', '259613916', '274903970', '261991370', '268455287', '260341347', '317353870', '262820765', '273967967'] },
    { '12 H': ['270132414', '266928528', '264865219', '266607110', '310234247', '262402122', '272961981', '261455818', '266332676', '267911920', '264042301', '261470256', '264419120', '259854506', '275181995', '255472315', '262420279', '257205640', '269466240', '269788875', '264289994'] },

    { '101': ['267363672', '278648495', '318055767', '273560670', '265695635', '259204498', '265102570', '275268373', '263887103', '272404071', '270671137', '262784360', '312702310', '304526738'] },
    { '102': ['278606083', '263636950', '268447748', '269058508', '268998876', '266140475', '275106497', '274343479', '265440831', '266125190', '265408504', '269089756', '266112668', '267534671', '270343776', '268087334', '274809273', '274679051', '271436158', '266119832', '266262686', '302319590'] },
    { '103': ['322870356', '272404179', '269418342', '274350084', '274484706', '265253675', '272409332', '266108040', '273674226', '269113959', '292106149', '314020640', '281805113', '275539172', '266801145', '255661169', '268767696', '269412743', '262939789', '267203357'] },
    { '104': ['269249710', '298685051', '260156949', '271490900', '269125884', '267298331', '266026184', '280163819', '274896109', '324193203', '269843353', '278320830', '271255234', '265006562'] },
    { '105': ['278797229', '270108270', '269233954', '275429245', '271754567', '266252788', '273419285', '267952740', '265159547', '270170707', '272419214', '273924800', '274677423'] },
    { '106': ['271390638', '269042440', '282869115', '276575270', '273173324', '314864652', '267464967', '274097974', '273288970', '262222795', '266585027', '275545644', '314865551', '275259749', '268843791'] },

    { '111': ['274563843', '266806120', '266714838', '259362581', '265690650', '260481386', '269991522', '268512680', '264684079', '313872368', '266857043', '275134105', '302491813', '257081224', '261187058'] },
    { '112': ['268735310', '274172666', '274801850', '264334035', '266479707', '305769995', '262408767', '261166590', '265581710'] },
    { '113': ['266191444', '266400604', '259273279', '317818350', '302491716', '317354256', '275900568', '273661787'] },
    { '114': ['265395135', '272411450', '264401379', '257994670', '274545128'] },

    { '121': ['266584489', '274108348', '261067419', '262236680', '253270154', '274365480', '265701180', '266335586', '276974131', '273702688', '261924630', '264857593', '273600168', '278448542'] },
    { '122': ['261398040', '267986947', '302958967', '255232950', '260277517', '258304057', '259378801', '250540711', '270249753', '263205282', '261287206', '255007736', '253208661'] },
    { '123': ['278608817', '259459070', '310555469', '244019142', '259080012', '302490841', '274408546', '275967778', '263162834'] },
    { '124': ['258105291', '260519014', '273497324', '272251763', '256149135', '256389004', '262786117', '266966764', '259388220'] },
  ];

  for (let index = 0; index < studentNifsByClassName.length; index++) {
    const nifsByClassName = Object.values(studentNifsByClassName)[index];
    const reportNameSuffix = Object.keys(nifsByClassName)[0].replaceAll(' ', '-').toLowerCase();

    await generateStudentAssignmentsByClassNameReport(
      nifsByClassName,
      `student-assignments-${reportNameSuffix}`,
    );
  }
}

run();
